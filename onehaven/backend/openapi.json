{"openapi":"3.1.0","info":{"title":"OneHaven - Lead Truth Engine","version":"0.1.0"},"paths":{"/jobs/refresh":{"post":{"summary":"Jobs Refresh","description":"Refresh priority:\n  1) zips\n  2) city\n  3) region","operationId":"jobs_refresh_jobs_refresh_post","parameters":[{"name":"region","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Named region, e.g. se_michigan","title":"Region"},"description":"Named region, e.g. se_michigan"},{"name":"zips","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Comma-separated zip list, e.g. 48362,48363","title":"Zips"},"description":"Comma-separated zip list, e.g. 48362,48363"},{"name":"city","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"City name, e.g. 'lake orion' or 'clarkston'","title":"City"},"description":"City name, e.g. 'lake orion' or 'clarkston'"},{"name":"max_price","in":"query","required":false,"schema":{"anyOf":[{"type":"number"},{"type":"null"}],"description":"Optional listing price ceiling","title":"Max Price"},"description":"Optional listing price ceiling"},{"name":"per_zip_limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":200,"title":"Per Zip Limit"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Jobs Refresh Jobs Refresh Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/jobs/dispatch":{"post":{"summary":"Dispatch Outbox","operationId":"dispatch_outbox_jobs_dispatch_post","parameters":[{"name":"batch_size","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":50,"title":"Batch Size"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DispatchResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/integrations":{"post":{"summary":"Create Integration","operationId":"create_integration_integrations_post","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntegrationCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntegrationOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"summary":"List Integrations","operationId":"list_integrations_integrations_get","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/IntegrationOut"},"title":"Response List Integrations Integrations Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/integrations/{integration_id}":{"patch":{"summary":"Update Integration","operationId":"update_integration_integrations__integration_id__patch","parameters":[{"name":"integration_id","in":"path","required":true,"schema":{"type":"integer","title":"Integration Id"}},{"name":"enabled","in":"query","required":false,"schema":{"anyOf":[{"type":"boolean"},{"type":"null"}],"title":"Enabled"}},{"name":"url","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url"}},{"name":"secret","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Secret"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/IntegrationOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/leads/top":{"get":{"summary":"Top Leads","operationId":"top_leads_leads_top_get","parameters":[{"name":"zip","in":"query","required":true,"schema":{"type":"string","minLength":5,"maxLength":10,"title":"Zip"}},{"name":"strategy","in":"query","required":false,"schema":{"type":"string","default":"rental","title":"Strategy"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":25,"title":"Limit"}},{"name":"max_price","in":"query","required":false,"schema":{"anyOf":[{"type":"number","minimum":0.0},{"type":"null"}],"title":"Max Price"}},{"name":"source","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Source"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/LeadOut"},"title":"Response Top Leads Leads Top Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/leads/{lead_id}/status":{"post":{"summary":"Set Lead Status","operationId":"set_lead_status_leads__lead_id__status_post","parameters":[{"name":"lead_id","in":"path","required":true,"schema":{"type":"integer","title":"Lead Id"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LeadStatusUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutcomeOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/events/outcome":{"post":{"summary":"Create Outcome","operationId":"create_outcome_events_outcome_post","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutcomeCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OutcomeOut"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/metrics/conversion":{"get":{"summary":"Metrics Conversion","operationId":"metrics_conversion_metrics_conversion_get","parameters":[{"name":"zip","in":"query","required":true,"schema":{"type":"string","title":"Zip"}},{"name":"strategy","in":"query","required":false,"schema":{"type":"string","default":"rental","title":"Strategy"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ScoreBucketMetrics"},"title":"Response Metrics Conversion Metrics Conversion Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/metrics/time-to-contact":{"get":{"summary":"Metrics Time To Contact","operationId":"metrics_time_to_contact_metrics_time_to_contact_get","parameters":[{"name":"zip","in":"query","required":true,"schema":{"type":"string","title":"Zip"}},{"name":"strategy","in":"query","required":false,"schema":{"type":"string","default":"rental","title":"Strategy"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TimeToContactMetrics"},"title":"Response Metrics Time To Contact Metrics Time To Contact Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/metrics/roi":{"get":{"summary":"Metrics Roi","operationId":"metrics_roi_metrics_roi_get","parameters":[{"name":"zip","in":"query","required":true,"schema":{"type":"string","title":"Zip"}},{"name":"strategy","in":"query","required":false,"schema":{"type":"string","default":"rental","title":"Strategy"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RoiMetrics"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/health":{"get":{"summary":"Health","operationId":"health_health_get","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/connectors/wayne/health":{"get":{"summary":"Wayne Health","operationId":"wayne_health_connectors_wayne_health_get","parameters":[{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/connectors/wayne/test":{"get":{"summary":"Wayne Test","operationId":"wayne_test_connectors_wayne_test_get","parameters":[{"name":"zip","in":"query","required":true,"schema":{"type":"string","title":"Zip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":200,"minimum":1,"default":50,"title":"Limit"}},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/debug/leads/stats":{"get":{"summary":"Debug Leads Stats","operationId":"debug_leads_stats_debug_leads_stats_get","parameters":[{"name":"zips","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Comma-separated zips filter","title":"Zips"},"description":"Comma-separated zips filter"},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/debug/leads/quality":{"get":{"summary":"Debug Leads Quality","description":"Data quality gates dashboard.\nShows missing-field rates and basic sanity failure rates by zip.\n\nThis is what stops “garbage leads” from quietly dominating your queue.","operationId":"debug_leads_quality_debug_leads_quality_get","parameters":[{"name":"zips","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Comma-separated zips filter","title":"Zips"},"description":"Comma-separated zips filter"},{"name":"strategy","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional: rental|flip","title":"Strategy"},"description":"Optional: rental|flip"},{"name":"X-API-Key","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Api-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"DispatchResult":{"properties":{"delivered":{"type":"integer","title":"Delivered"},"failed":{"type":"integer","title":"Failed"},"sinks":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Sinks"},"events":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Events"},"skipped_no_sinks":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Skipped No Sinks"}},"type":"object","required":["delivered","failed"],"title":"DispatchResult"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"IntegrationCreate":{"properties":{"name":{"type":"string","title":"Name"},"type":{"type":"string","enum":["webhook"],"const":"webhook","title":"Type","default":"webhook"},"enabled":{"type":"boolean","title":"Enabled","default":true},"url":{"type":"string","title":"Url"},"secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Secret"}},"type":"object","required":["name","url"],"title":"IntegrationCreate"},"IntegrationOut":{"properties":{"id":{"type":"integer","title":"Id"},"name":{"type":"string","title":"Name"},"type":{"type":"string","title":"Type"},"enabled":{"type":"boolean","title":"Enabled"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","name","type","enabled","created_at"],"title":"IntegrationOut"},"LeadOut":{"properties":{"id":{"type":"integer","title":"Id"},"property_id":{"type":"integer","title":"Property Id"},"source":{"type":"string","title":"Source"},"status":{"type":"string","title":"Status"},"strategy":{"type":"string","title":"Strategy"},"rank_score":{"type":"number","title":"Rank Score"},"deal_score":{"type":"number","title":"Deal Score"},"motivation_score":{"type":"number","title":"Motivation Score"},"explain":{"type":"string","title":"Explain"},"address_line":{"type":"string","title":"Address Line"},"city":{"type":"string","title":"City"},"state":{"type":"string","title":"State"},"zipcode":{"type":"string","title":"Zipcode"},"list_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"List Price"},"arv_estimate":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Arv Estimate"},"rent_estimate":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Rent Estimate"},"rehab_estimate":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Rehab Estimate"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","property_id","source","status","strategy","rank_score","deal_score","motivation_score","explain","address_line","city","state","zipcode","created_at"],"title":"LeadOut"},"LeadStatusUpdate":{"properties":{"status":{"type":"string","enum":["new","qualified","contacted","under_contract","closed","dead"],"title":"Status"},"occurred_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Occurred At"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"}},"type":"object","required":["status"],"title":"LeadStatusUpdate"},"OutcomeCreate":{"properties":{"lead_id":{"type":"integer","title":"Lead Id"},"outcome_type":{"type":"string","enum":["contacted","responded","appointment_set","under_contract","closed","dead","mls_pending","mls_closed"],"title":"Outcome Type"},"occurred_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Occurred At"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"},"contract_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Contract Price"},"realized_profit":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Realized Profit"},"source":{"type":"string","title":"Source","default":"manual"}},"type":"object","required":["lead_id","outcome_type"],"title":"OutcomeCreate"},"OutcomeOut":{"properties":{"id":{"type":"integer","title":"Id"},"lead_id":{"type":"integer","title":"Lead Id"},"outcome_type":{"type":"string","title":"Outcome Type"},"occurred_at":{"type":"string","format":"date-time","title":"Occurred At"},"source":{"type":"string","title":"Source"},"notes":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Notes"},"contract_price":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Contract Price"},"realized_profit":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Realized Profit"}},"type":"object","required":["id","lead_id","outcome_type","occurred_at","source"],"title":"OutcomeOut"},"RoiMetrics":{"properties":{"count_closed_with_profit":{"type":"integer","title":"Count Closed With Profit"},"avg_realized_profit":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Avg Realized Profit"},"median_realized_profit":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Median Realized Profit"}},"type":"object","required":["count_closed_with_profit","avg_realized_profit","median_realized_profit"],"title":"RoiMetrics"},"ScoreBucketMetrics":{"properties":{"bucket":{"type":"string","title":"Bucket"},"count":{"type":"integer","title":"Count"},"responded_rate":{"type":"number","title":"Responded Rate"},"appointment_rate":{"type":"number","title":"Appointment Rate"},"contract_rate":{"type":"number","title":"Contract Rate"},"close_rate":{"type":"number","title":"Close Rate"}},"type":"object","required":["bucket","count","responded_rate","appointment_rate","contract_rate","close_rate"],"title":"ScoreBucketMetrics"},"TimeToContactMetrics":{"properties":{"bucket":{"type":"string","title":"Bucket"},"median_minutes_to_contact":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Median Minutes To Contact"},"count_with_contact":{"type":"integer","title":"Count With Contact"}},"type":"object","required":["bucket","median_minutes_to_contact","count_with_contact"],"title":"TimeToContactMetrics"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}